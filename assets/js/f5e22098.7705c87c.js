"use strict";(self.webpackChunkcosmos_sdk_docs=self.webpackChunkcosmos_sdk_docs||[]).push([[1407],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>c});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),d=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,l=e.originalType,s=e.parentName,p=r(e,["components","mdxType","originalType","parentName"]),u=d(n),c=i,k=u["".concat(s,".").concat(c)]||u[c]||m[c]||l;return n?a.createElement(k,o(o({ref:t},p),{},{components:n})):a.createElement(k,o({ref:t},p))}));function c(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var l=n.length,o=new Array(l);o[0]=u;var r={};for(var s in t)hasOwnProperty.call(t,s)&&(r[s]=t[s]);r.originalType=e,r.mdxType="string"==typeof e?e:i,o[1]=r;for(var d=2;d<l;d++)o[d]=n[d];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},75381:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>m,frontMatter:()=>l,metadata:()=>r,toc:()=>d});var a=n(87462),i=(n(67294),n(3905));const l={},o="ADR 050: SIGN_MODE_TEXTUAL: Annex 1 Value Renderers",r={unversionedId:"architecture/adr-050-sign-mode-textual-annex1",id:"version-v0.47/architecture/adr-050-sign-mode-textual-annex1",title:"ADR 050: SIGN_MODE_TEXTUAL: Annex 1 Value Renderers",description:"Changelog",source:"@site/versioned_docs/version-v0.47/architecture/adr-050-sign-mode-textual-annex1.md",sourceDirName:"architecture",slug:"/architecture/adr-050-sign-mode-textual-annex1",permalink:"/v0.47/architecture/adr-050-sign-mode-textual-annex1",draft:!1,tags:[],version:"v0.47",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"ADR 049: State Sync Hooks",permalink:"/v0.47/architecture/adr-049-state-sync-hooks"},next:{title:"ADR 050: SIGN_MODE_TEXTUAL: Annex 2 XXX",permalink:"/v0.47/architecture/adr-050-sign-mode-textual-annex2"}},s={},d=[{value:"Changelog",id:"changelog",level:2},{value:"Status",id:"status",level:2},{value:"Abstract",id:"abstract",level:2},{value:"Value Renderers",id:"value-renderers",level:2},{value:"Protobuf <code>number</code>",id:"protobuf-number",level:3},{value:"Examples",id:"examples",level:4},{value:"<code>coin</code>",id:"coin",level:3},{value:"Examples",id:"examples-1",level:4},{value:"<code>coins</code>",id:"coins",level:3},{value:"Example",id:"example",level:3},{value:"<code>repeated</code>",id:"repeated",level:3},{value:"Examples",id:"examples-2",level:4},{value:"<code>message</code>",id:"message",level:3},{value:"Examples",id:"examples-3",level:4},{value:"Enums",id:"enums",level:3},{value:"Examples",id:"examples-4",level:4},{value:"<code>google.protobuf.Any</code>",id:"googleprotobufany",level:3},{value:"Examples",id:"examples-5",level:4},{value:"<code>google.protobuf.Timestamp</code>",id:"googleprotobuftimestamp",level:3},{value:"Examples",id:"examples-6",level:4},{value:"<code>google.protobuf.Duration</code>",id:"googleprotobufduration",level:3},{value:"bytes",id:"bytes",level:3},{value:"address bytes",id:"address-bytes",level:3},{value:"strings",id:"strings",level:3},{value:"Default Values",id:"default-values",level:3},{value:"Example",id:"example-1",level:4},{value:"ABANDONED Custom <code>msg_title</code> instead of Msg <code>type_url</code>",id:"abandoned-custom-msg_title-instead-of-msg-type_url",level:3},{value:"Examples",id:"examples-7",level:4},{value:"Best Pratices",id:"best-pratices",level:4}],p={toc:d};function m(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"adr-050-sign_mode_textual-annex-1-value-renderers"},"ADR 050: SIGN_MODE_TEXTUAL: Annex 1 Value Renderers"),(0,i.kt)("h2",{id:"changelog"},"Changelog"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Dec 06, 2021: Initial Draft"),(0,i.kt)("li",{parentName:"ul"},"Feb 07, 2022: Draft read and concept-ACKed by the Ledger team.")),(0,i.kt)("h2",{id:"status"},"Status"),(0,i.kt)("p",null,"Accepted. Implementation started. Small value renderers details still need to be polished."),(0,i.kt)("h2",{id:"abstract"},"Abstract"),(0,i.kt)("p",null,"This Annex describes value renderers, which are used for displaying Protobuf values in a human-friendly way using a string array."),(0,i.kt)("h2",{id:"value-renderers"},"Value Renderers"),(0,i.kt)("p",null,"Value Renderers describe how values of different Protobuf types should be encoded as a string array. Value renderers can be formalized as a set of bijective functions ",(0,i.kt)("inlineCode",{parentName:"p"},"func renderT(value T) []string"),", where ",(0,i.kt)("inlineCode",{parentName:"p"},"T")," is one of the below Protobuf types for which this spec is defined."),(0,i.kt)("h3",{id:"protobuf-number"},"Protobuf ",(0,i.kt)("inlineCode",{parentName:"h3"},"number")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Applies to:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"protobuf numeric integer types (",(0,i.kt)("inlineCode",{parentName:"li"},"int{32,64}"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"uint{32,64}"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"sint{32,64}"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"fixed{32,64}"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"sfixed{32,64}"),")"),(0,i.kt)("li",{parentName:"ul"},"strings whose ",(0,i.kt)("inlineCode",{parentName:"li"},"customtype")," is ",(0,i.kt)("inlineCode",{parentName:"li"},"github.com/cosmos/cosmos-sdk/types.Int")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"github.com/cosmos/cosmos-sdk/types.Dec")),(0,i.kt)("li",{parentName:"ul"},"bytes whose ",(0,i.kt)("inlineCode",{parentName:"li"},"customtype")," is ",(0,i.kt)("inlineCode",{parentName:"li"},"github.com/cosmos/cosmos-sdk/types.Int")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"github.com/cosmos/cosmos-sdk/types.Dec")))),(0,i.kt)("li",{parentName:"ul"},"Trailing decimal zeroes are always removed"),(0,i.kt)("li",{parentName:"ul"},"Formatting with ",(0,i.kt)("inlineCode",{parentName:"li"},"'"),"s for every three integral digits."),(0,i.kt)("li",{parentName:"ul"},"Usage of ",(0,i.kt)("inlineCode",{parentName:"li"},".")," to denote the decimal delimiter.")),(0,i.kt)("h4",{id:"examples"},"Examples"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"1000")," (uint64) -> ",(0,i.kt)("inlineCode",{parentName:"li"},"1'000")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},'"1000000.00"')," (string representing a Dec) -> ",(0,i.kt)("inlineCode",{parentName:"li"},"1'000'000")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},'"1000000.10"')," (string representing a Dec) -> ",(0,i.kt)("inlineCode",{parentName:"li"},"1'000'000.1"))),(0,i.kt)("h3",{id:"coin"},(0,i.kt)("inlineCode",{parentName:"h3"},"coin")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Applies to ",(0,i.kt)("inlineCode",{parentName:"li"},"cosmos.base.v1beta1.Coin"),"."),(0,i.kt)("li",{parentName:"ul"},"Denoms are converted to ",(0,i.kt)("inlineCode",{parentName:"li"},"display")," denoms using ",(0,i.kt)("inlineCode",{parentName:"li"},"Metadata")," (if available). ",(0,i.kt)("strong",{parentName:"li"},"This requires a state query"),". The definition of ",(0,i.kt)("inlineCode",{parentName:"li"},"Metadata")," can be found in the ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/cosmos/cosmos-sdk/blob/v0.46.0/proto/cosmos/bank/v1beta1/bank.proto#L79-L108"},"bank Protobuf definition"),". If the ",(0,i.kt)("inlineCode",{parentName:"li"},"display")," field is empty or nil, then we do not perform any denom conversion."),(0,i.kt)("li",{parentName:"ul"},"Amounts are converted to ",(0,i.kt)("inlineCode",{parentName:"li"},"display")," denom amounts and rendered as ",(0,i.kt)("inlineCode",{parentName:"li"},"number"),"s above",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"We do not change the capitalization of the denom. In practice, ",(0,i.kt)("inlineCode",{parentName:"li"},"display")," denoms are stored in lowercase in state (e.g. ",(0,i.kt)("inlineCode",{parentName:"li"},"10 atom"),"), however they are often showed in UPPERCASE in everyday life (e.g. ",(0,i.kt)("inlineCode",{parentName:"li"},"10 ATOM"),"). Value renderers keep the case used in state, but we may recommend chains changing the denom metadata to be uppercase for better user display."))),(0,i.kt)("li",{parentName:"ul"},"One space between the denom and amount (e.g. ",(0,i.kt)("inlineCode",{parentName:"li"},"10 atom"),")."),(0,i.kt)("li",{parentName:"ul"},"In the future, IBC denoms could maybe be converted to DID/IIDs, if we can find a robust way for doing this (ex. ",(0,i.kt)("inlineCode",{parentName:"li"},"cosmos:cosmos:hub:bank:denom:atom"),")")),(0,i.kt)("h4",{id:"examples-1"},"Examples"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"1000000000uatom")," -> ",(0,i.kt)("inlineCode",{parentName:"li"},'["1\'000 atom"]'),", because atom is the metadata's display denom.")),(0,i.kt)("h3",{id:"coins"},(0,i.kt)("inlineCode",{parentName:"h3"},"coins")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"an array of ",(0,i.kt)("inlineCode",{parentName:"li"},"coin")," is display as the concatenation of each ",(0,i.kt)("inlineCode",{parentName:"li"},"coin")," encoded as the specification above, the joined together with the delimiter ",(0,i.kt)("inlineCode",{parentName:"li"},'", "')," (a comma and a space, no quotes around)."),(0,i.kt)("li",{parentName:"ul"},"the list of coins is ordered by unicode code point of the display denom: ",(0,i.kt)("inlineCode",{parentName:"li"},"A-Z")," < ",(0,i.kt)("inlineCode",{parentName:"li"},"a-z"),". For example, the string ",(0,i.kt)("inlineCode",{parentName:"li"},"aAbBcC")," would be sorted ",(0,i.kt)("inlineCode",{parentName:"li"},"ABCabc"),".")),(0,i.kt)("h3",{id:"example"},"Example"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},'["3cosm", "2000000uatom"]')," -> ",(0,i.kt)("inlineCode",{parentName:"li"},"2 atom, 3 COSM")," (assuming the display denoms are ",(0,i.kt)("inlineCode",{parentName:"li"},"atom")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"COSM"),")"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},'["10atom", "20Acoin"]')," -> ",(0,i.kt)("inlineCode",{parentName:"li"},"20 Acoin, 10 atom")," (assuming the display denoms are ",(0,i.kt)("inlineCode",{parentName:"li"},"atom")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"Acoin"),")")),(0,i.kt)("h3",{id:"repeated"},(0,i.kt)("inlineCode",{parentName:"h3"},"repeated")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Applies to all ",(0,i.kt)("inlineCode",{parentName:"li"},"repeated")," fields, except ",(0,i.kt)("inlineCode",{parentName:"li"},"cosmos.tx.v1beta1.TxBody#Messages"),", which has a particular encoding (see ",(0,i.kt)("a",{parentName:"li",href:"/v0.47/architecture/adr-050-sign-mode-textual"},"ADR-050"),")."),(0,i.kt)("li",{parentName:"ul"},"A repeated type has the following template:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"<message_name> has <int> <field_name>\n<field_name> (<int>/<int>): <value rendered 1st line>\n<optional value rendered in the next lines>\n<field_name> (<int>/<int>): <value rendered 1st line>\n<optional value rendered in the next lines>\nEnd of <field_name>.\n")),(0,i.kt)("p",null,"where:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"message_name")," is the name of the Protobuf message which holds the ",(0,i.kt)("inlineCode",{parentName:"li"},"repeated")," field,"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"int")," is the length of the array,"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"field_name")," is the Protobuf field name of the repeated field,",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"add an optional ",(0,i.kt)("inlineCode",{parentName:"li"},"s")," at the end if ",(0,i.kt)("inlineCode",{parentName:"li"},"<int> > 1")," and the ",(0,i.kt)("inlineCode",{parentName:"li"},"field_name")," doesn't already end with ",(0,i.kt)("inlineCode",{parentName:"li"},"s"),".")))),(0,i.kt)("h4",{id:"examples-2"},"Examples"),(0,i.kt)("p",null,"Given the proto definition:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-protobuf"},"message AllowedMsgAllowance {\n  repeated string allowed_messages = 1;\n}\n")),(0,i.kt)("p",null,"and initializing with:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-go"},'x := []AllowedMsgAllowance{"cosmos.bank.v1beta1.MsgSend", "cosmos.gov.v1.MsgVote"}\n')),(0,i.kt)("p",null,"we have the following value-rendered encoding:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Allowed messages: 2 strings\nAllowed messages (1/2): cosmos.bank.v1beta1.MsgSend\nAllowed messages (2/2): cosmos.gov.v1.MsgVote\nEnd of Allowed messages\n")),(0,i.kt)("h3",{id:"message"},(0,i.kt)("inlineCode",{parentName:"h3"},"message")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Applies to Protobuf messages whose name does not start with ",(0,i.kt)("inlineCode",{parentName:"li"},"Msg"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"For ",(0,i.kt)("inlineCode",{parentName:"li"},"sdk.Msg"),"s, please see ",(0,i.kt)("a",{parentName:"li",href:"/v0.47/architecture/adr-050-sign-mode-textual"},"ADR-050")),(0,i.kt)("li",{parentName:"ul"},"alternatively, we can decide to add a protobuf option to denote messages that are ",(0,i.kt)("inlineCode",{parentName:"li"},"sdk.Msg"),"s."))),(0,i.kt)("li",{parentName:"ul"},"Field names follow ",(0,i.kt)("a",{parentName:"li",href:"https://en.wiktionary.org/wiki/sentence_case"},"sentence case"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"replace ",(0,i.kt)("inlineCode",{parentName:"li"},"_")," with a spaces"),(0,i.kt)("li",{parentName:"ul"},"capitalize first letter of the setence"))),(0,i.kt)("li",{parentName:"ul"},"Field names are ordered by their Protobuf field number"),(0,i.kt)("li",{parentName:"ul"},"Nesting:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"if a field contains a nested message, we value-render the underlying message using the template:")),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"<field_name>: <1st line of value-rendered message>\n> <lines 2-n of value-rendered message>             // Notice the `>` prefix.\n")),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},">")," character is used to denote nesting. For each additional level of nesting, add ",(0,i.kt)("inlineCode",{parentName:"li"},">"),".")))),(0,i.kt)("h4",{id:"examples-3"},"Examples"),(0,i.kt)("p",null,"Given the following Protobuf messages:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-protobuf"},'enum VoteOption {\n  VOTE_OPTION_UNSPECIFIED = 0;\n  VOTE_OPTION_YES = 1;\n  VOTE_OPTION_ABSTAIN = 2;\n  VOTE_OPTION_NO = 3;\n  VOTE_OPTION_NO_WITH_VETO = 4;\n}\n\nmessage WeightedVoteOption {\n  VoteOption option = 1;\n  string     weight = 2 [(cosmos_proto.scalar) = "cosmos.Dec"];\n}\n\nmessage Vote {\n  uint64 proposal_id = 1;\n  string voter       = 2 [(cosmos_proto.scalar) = "cosmos.AddressString"];\n  reserved 3;\n  repeated WeightedVoteOption options = 4;\n}\n')),(0,i.kt)("p",null,"we get the following encoding for the ",(0,i.kt)("inlineCode",{parentName:"p"},"Vote")," message:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Vote object\n> Proposal id: 4\n> Vote: cosmos1abc...def\n> Options: 2 WeightedVoteOptions\n> Options (1/2): WeightedVoteOption object\n>> Option: Yes\n>> Weight: 0.7\n> Options (2/2): WeightedVoteOption object\n>> Option: No\n>> Weight: 0.3\n> End of Options\n")),(0,i.kt)("h3",{id:"enums"},"Enums"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"String case convention: snake case to sentence case"),(0,i.kt)("li",{parentName:"ul"},"Allow optional annotation for textual name (TBD)"),(0,i.kt)("li",{parentName:"ul"},"Algorithm:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"convert enum name (",(0,i.kt)("inlineCode",{parentName:"li"},"VoteOption"),") to snake_case (",(0,i.kt)("inlineCode",{parentName:"li"},"VOTE_OPTION"),")"),(0,i.kt)("li",{parentName:"ul"},"truncate that prefix + ",(0,i.kt)("inlineCode",{parentName:"li"},"_")," from the enum name if it exists (",(0,i.kt)("inlineCode",{parentName:"li"},"VOTE_OPTION_")," gets stripped from ",(0,i.kt)("inlineCode",{parentName:"li"},"VOTE_OPTION_YES")," -> ",(0,i.kt)("inlineCode",{parentName:"li"},"YES"),")"),(0,i.kt)("li",{parentName:"ul"},"convert rest to sentence case: ",(0,i.kt)("inlineCode",{parentName:"li"},"YES")," -> ",(0,i.kt)("inlineCode",{parentName:"li"},"Yes")),(0,i.kt)("li",{parentName:"ul"},"in summary: ",(0,i.kt)("inlineCode",{parentName:"li"},"VOTE_OPTION_YES")," -> ",(0,i.kt)("inlineCode",{parentName:"li"},"Yes"))))),(0,i.kt)("h4",{id:"examples-4"},"Examples"),(0,i.kt)("p",null,"See example above with ",(0,i.kt)("inlineCode",{parentName:"p"},"message Vote{}"),"."),(0,i.kt)("h3",{id:"googleprotobufany"},(0,i.kt)("inlineCode",{parentName:"h3"},"google.protobuf.Any")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Applies to ",(0,i.kt)("inlineCode",{parentName:"li"},"google.protobuf.Any")),(0,i.kt)("li",{parentName:"ul"},"Rendered as:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Object: <type_url>\n> <value rendered underlying message>\n")),(0,i.kt)("h4",{id:"examples-5"},"Examples"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Object: /cosmos.gov.v1.Vote\n> Proposal id: 4\n> Vote: cosmos1abc...def\n> Options: 2 WeightedVoteOptions\n> Options (1/2): WeightedVoteOption object\n>> Option: Yes\n>> Weight: 0.7\n> Options (2/2): WeightedVoteOption object\n>> Option: No\n>> Weight: 0.3\n> End of Options\n")),(0,i.kt)("h3",{id:"googleprotobuftimestamp"},(0,i.kt)("inlineCode",{parentName:"h3"},"google.protobuf.Timestamp")),(0,i.kt)("p",null,"Rendered using ",(0,i.kt)("a",{parentName:"p",href:"https://www.rfc-editor.org/rfc/rfc3339"},"RFC 3339"),' (a\nsimplification of ISO 8601), which is the current recommendation for portable\ntime values. The rendering always uses "Z" (UTC) as the timezone. It uses only\nthe necessary fractional digits of a second, omitting the fractional part\nentirely if the timestamp has no fractional seconds. (The resulting timestamps\nare not automatically sortable by standard lexicographic order, but we favor\nthe legibility of the shorter string.)'),(0,i.kt)("h4",{id:"examples-6"},"Examples"),(0,i.kt)("p",null,"The timestamp with 1136214245 seconds and 700000000 nanoseconds is rendered\nas ",(0,i.kt)("inlineCode",{parentName:"p"},"2006-01-02T15:04:05.7Z"),".\nThe timestamp with 1136214245 seconds and zero nanoseconds is rendered\nas ",(0,i.kt)("inlineCode",{parentName:"p"},"2006-01-02T15:04:05Z"),"."),(0,i.kt)("h3",{id:"googleprotobufduration"},(0,i.kt)("inlineCode",{parentName:"h3"},"google.protobuf.Duration")),(0,i.kt)("p",null,"The duration proto expresses a raw number of seconds and nanoseconds.\nThis will be rendered as longer time units of days, hours, and minutes,\nplus any remaining seconds, in that order.\nLeading and trailing zero-quantity units will be omitted, but all\nunits in between nonzero units will be shown, e.g. ",(0,i.kt)("inlineCode",{parentName:"p"}," 3 days, 0 hours, 0 minutes, 5 seconds"),"."),(0,i.kt)("p",null,"Even longer time units such as months or years are imprecise.\nWeeks are precise, but not commonly used - ",(0,i.kt)("inlineCode",{parentName:"p"},"91 days")," is more immediately\nlegible than ",(0,i.kt)("inlineCode",{parentName:"p"},"13 weeks"),".  Although ",(0,i.kt)("inlineCode",{parentName:"p"},"days")," can be problematic,\ne.g. noon to noon on subsequent days can be 23 or 25 hours depending on\ndaylight savings transitions, there is significant advantage in using\nstrict 24-hour days over using only hours (e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"91 days")," vs ",(0,i.kt)("inlineCode",{parentName:"p"},"2184 hours"),")."),(0,i.kt)("p",null,"When nanoseconds are nonzero, they will be shown as fractional seconds,\nwith only the minimum number of digits, e.g ",(0,i.kt)("inlineCode",{parentName:"p"},"0.5 seconds"),"."),(0,i.kt)("p",null,"A duration of exactly zero is shown as ",(0,i.kt)("inlineCode",{parentName:"p"},"0 seconds"),"."),(0,i.kt)("p",null,"Units will be given as singular (no trailing ",(0,i.kt)("inlineCode",{parentName:"p"},"s"),") when the quantity is exactly one,\nand will be shown in plural otherwise."),(0,i.kt)("p",null,"Negative durations will be indicated with a leading minus sign (",(0,i.kt)("inlineCode",{parentName:"p"},"-"),")."),(0,i.kt)("p",null,"Examples:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"1 day")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"30 days")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"-1 day, 12 hours")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"3 hours, 0 minutes, 53.025 seconds"))),(0,i.kt)("h3",{id:"bytes"},"bytes"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Bytes are rendered in hexadecimal, all capital letters, without the ",(0,i.kt)("inlineCode",{parentName:"li"},"0x")," prefix.")),(0,i.kt)("h3",{id:"address-bytes"},"address bytes"),(0,i.kt)("p",null,"We currently use ",(0,i.kt)("inlineCode",{parentName:"p"},"string")," types in protobuf for addresses so this may not be needed, but if any address bytes are used in sign mode textual they should be rendered with bech32 formatting"),(0,i.kt)("h3",{id:"strings"},"strings"),(0,i.kt)("p",null,"Strings are rendered as-is."),(0,i.kt)("h3",{id:"default-values"},"Default Values"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Default Protobuf values for each field are skipped.")),(0,i.kt)("h4",{id:"example-1"},"Example"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-protobuf"},"message TestData {\n  string signer = 1;\n  string metadata = 2;\n}\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-go"},'myTestData := TestData{\n  Signer: "cosmos1abc"\n}\n')),(0,i.kt)("p",null,"We get the following encoding for the ",(0,i.kt)("inlineCode",{parentName:"p"},"TestData")," message:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"TestData object\n> Signer: cosmos1abc\n")),(0,i.kt)("h3",{id:"abandoned-custom-msg_title-instead-of-msg-type_url"},"[ABANDONED]"," Custom ",(0,i.kt)("inlineCode",{parentName:"h3"},"msg_title")," instead of Msg ",(0,i.kt)("inlineCode",{parentName:"h3"},"type_url")),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"This paragraph is in the Annex for informational purposes only, and will be removed in a next update of the ADR.")),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Click to see abandoned idea."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"all protobuf messages to be used with ",(0,i.kt)("inlineCode",{parentName:"li"},"SIGN_MODE_TEXTUAL")," CAN have a short title associated with them that can be used in format strings whenever the type URL is explicitly referenced via the ",(0,i.kt)("inlineCode",{parentName:"li"},"cosmos.msg.v1.textual.msg_title")," Protobuf message option."),(0,i.kt)("li",{parentName:"ul"},"if this option is not specified for a Msg, then the Protobuf fully qualified name will be used.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-protobuf"},'message MsgSend {\n  option (cosmos.msg.v1.textual.msg_title) = "bank send coins";\n}\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"they MUST be unique per message, per chain")),(0,i.kt)("h4",{id:"examples-7"},"Examples"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"cosmos.gov.v1.MsgVote")," -> ",(0,i.kt)("inlineCode",{parentName:"li"},"governance v1 vote"))),(0,i.kt)("h4",{id:"best-pratices"},"Best Pratices"),(0,i.kt)("p",null,"We recommend to use this option only for ",(0,i.kt)("inlineCode",{parentName:"p"},"Msg"),"s whose Protobuf fully qualified name can be hard to understand. As such, the two examples above (",(0,i.kt)("inlineCode",{parentName:"p"},"MsgSend")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"MsgVote"),") are not good examples to be used with ",(0,i.kt)("inlineCode",{parentName:"p"},"msg_title"),". We still allow ",(0,i.kt)("inlineCode",{parentName:"p"},"msg_title")," for chains who might have ",(0,i.kt)("inlineCode",{parentName:"p"},"Msg"),"s with complex or non-obvious names."),(0,i.kt)("p",null,"In those cases, we recommend to drop the version (e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"v1"),") in the string if there's only one version of the module on chain. This way, the bijective mapping can figure out which message each string corresponds to. If multiple Protobuf versions of the same module exist on the same chain, we recommend keeping the first ",(0,i.kt)("inlineCode",{parentName:"p"},"msg_title")," with version, and the second ",(0,i.kt)("inlineCode",{parentName:"p"},"msg_title")," with version (e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"v2"),"):"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"mychain.mymodule.v1.MsgDo")," -> ",(0,i.kt)("inlineCode",{parentName:"li"},"mymodule do something")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"mychain.mymodule.v2.MsgDo")," -> ",(0,i.kt)("inlineCode",{parentName:"li"},"mymodule v2 do something")))))}m.isMDXComponent=!0}}]);