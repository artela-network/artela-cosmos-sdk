"use strict";(self.webpackChunkcosmos_sdk_docs=self.webpackChunkcosmos_sdk_docs||[]).push([[4841],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var i=n(67294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,i,s=function(e,t){if(null==e)return{};var n,i,s={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var l=i.createContext({}),u=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=u(e.components);return i.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},c=i.forwardRef((function(e,t){var n=e.components,s=e.mdxType,a=e.originalType,l=e.parentName,p=r(e,["components","mdxType","originalType","parentName"]),c=u(n),m=s,h=c["".concat(l,".").concat(m)]||c[m]||d[m]||a;return n?i.createElement(h,o(o({ref:t},p),{},{components:n})):i.createElement(h,o({ref:t},p))}));function m(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var a=n.length,o=new Array(a);o[0]=c;var r={};for(var l in t)hasOwnProperty.call(t,l)&&(r[l]=t[l]);r.originalType=e,r.mdxType="string"==typeof e?e:s,o[1]=r;for(var u=2;u<a;u++)o[u]=n[u];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}c.displayName="MDXCreateElement"},80284:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>r,toc:()=>u});var i=n(87462),s=(n(67294),n(3905));const a={},o="ADR 059: Test Scopes",r={unversionedId:"architecture/adr-059-test-scopes",id:"version-v0.50/architecture/adr-059-test-scopes",title:"ADR 059: Test Scopes",description:"Changelog",source:"@site/versioned_docs/version-v0.50/architecture/adr-059-test-scopes.md",sourceDirName:"architecture",slug:"/architecture/adr-059-test-scopes",permalink:"/v0.50/architecture/adr-059-test-scopes",draft:!1,tags:[],version:"v0.50",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"ADR 058: Auto-Generated CLI",permalink:"/v0.50/architecture/adr-058-auto-generated-cli"},next:{title:"ADR 60: ABCI 1.0 Integration (Phase I)",permalink:"/v0.50/architecture/adr-060-abci-1.0"}},l={},u=[{value:"Changelog",id:"changelog",level:2},{value:"Status",id:"status",level:2},{value:"Abstract",id:"abstract",level:2},{value:"Context",id:"context",level:2},{value:"Unit tests",id:"unit-tests",level:3},{value:"Limitations",id:"limitations",level:4},{value:"Integration tests",id:"integration-tests",level:3},{value:"Limitations",id:"limitations-1",level:4},{value:"Simulations",id:"simulations",level:3},{value:"Limitations",id:"limitations-2",level:4},{value:"E2E tests",id:"e2e-tests",level:3},{value:"Limitations",id:"limitations-3",level:4},{value:"Decision",id:"decision",level:2},{value:"Unit Tests",id:"unit-tests-1",level:3},{value:"Integration Tests",id:"integration-tests-1",level:3},{value:"Simulations",id:"simulations-1",level:3},{value:"E2E Tests",id:"e2e-tests-1",level:3},{value:"Consequences",id:"consequences",level:2},{value:"Positive",id:"positive",level:3},{value:"Negative",id:"negative",level:3},{value:"Neutral",id:"neutral",level:3},{value:"Further Discussions",id:"further-discussions",level:2}],p={toc:u};function d(e){let{components:t,...n}=e;return(0,s.kt)("wrapper",(0,i.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"adr-059-test-scopes"},"ADR 059: Test Scopes"),(0,s.kt)("h2",{id:"changelog"},"Changelog"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"2022-08-02: Initial Draft"),(0,s.kt)("li",{parentName:"ul"},"2023-03-02: Add precision for integration tests"),(0,s.kt)("li",{parentName:"ul"},"2023-03-23: Add precision for E2E tests")),(0,s.kt)("h2",{id:"status"},"Status"),(0,s.kt)("p",null,"PROPOSED Partially Implemented"),(0,s.kt)("h2",{id:"abstract"},"Abstract"),(0,s.kt)("p",null,"Recent work in the SDK aimed at breaking apart the monolithic root go module has highlighted\nshortcomings and inconsistencies in our testing paradigm. This ADR clarifies a common\nlanguage for talking about test scopes and proposes an ideal state of tests at each scope."),(0,s.kt)("h2",{id:"context"},"Context"),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/blob/main/docs/architecture/adr-053-go-module-refactoring.md"},"ADR-053: Go Module Refactoring")," expresses our desire for an SDK composed of many\nindependently versioned Go modules, and ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/blob/main/docs/architecture/adr-057-app-wiring.md"},"ADR-057: App Wiring")," offers a methodology\nfor breaking apart inter-module dependencies through the use of dependency injection. As\ndescribed in ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/issues/11899"},"EPIC: Separate all SDK modules into standalone go modules"),", module\ndependencies are particularly complected in the test phase, where simapp is used as\nthe key test fixture in setting up and running tests. It is clear that the successful\ncompletion of Phases 3 and 4 in that EPIC require the resolution of this dependency problem."),(0,s.kt)("p",null,"In ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/issues/12398"},"EPIC: Unit Testing of Modules via Mocks")," it was thought this Gordian knot could be\nunwound by mocking all dependencies in the test phase for each module, but seeing how these\nrefactors were complete rewrites of test suites discussions began around the fate of the\nexisting integration tests. One perspective is that they ought to be thrown out, another is\nthat integration tests have some utility of their own and a place in the SDK's testing story."),(0,s.kt)("p",null,"Another point of confusion has been the current state of CLI test suites, ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/blob/0f7e56c6f9102cda0ca9aba5b6f091dbca976b5a/x/auth/client/testutil/suite.go#L44-L49"},"x/auth")," for\nexample. In code these are called integration tests, but in reality function as end to end\ntests by starting up a tendermint node and full application. ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/issues/12696"},"EPIC: Rewrite and simplify\nCLI tests")," identifies the ideal state of CLI tests using mocks, but does not address the\nplace end to end tests may have in the SDK."),(0,s.kt)("p",null,"From here we identify three scopes of testing, ",(0,s.kt)("strong",{parentName:"p"},"unit"),", ",(0,s.kt)("strong",{parentName:"p"},"integration"),", ",(0,s.kt)("strong",{parentName:"p"},"e2e")," (end to\nend), seek to define the boundaries of each, their shortcomings (real and imposed), and their\nideal state in the SDK."),(0,s.kt)("h3",{id:"unit-tests"},"Unit tests"),(0,s.kt)("p",null,"Unit tests exercise the code contained in a single module (e.g. ",(0,s.kt)("inlineCode",{parentName:"p"},"/x/bank"),") or package\n(e.g. ",(0,s.kt)("inlineCode",{parentName:"p"},"/client"),") in isolation from the rest of the code base. Within this we identify two\nlevels of unit tests, ",(0,s.kt)("em",{parentName:"p"},"illustrative")," and ",(0,s.kt)("em",{parentName:"p"},"journey"),". The definitions below lean heavily on\n",(0,s.kt)("a",{parentName:"p",href:"https://leanpub.com/bddbooks-formulation"},"The BDD Books - Formulation")," section 1.3."),(0,s.kt)("p",null,(0,s.kt)("em",{parentName:"p"},"Illustrative")," tests exercise an atomic part of a module in isolation - in this case we\nmight do fixture setup/mocking of other parts of the module."),(0,s.kt)("p",null,"Tests which exercise a whole module's function with dependencies mocked, are ",(0,s.kt)("em",{parentName:"p"},"journeys"),".\nThese are almost like integration tests in that they exercise many things together but still\nuse mocks."),(0,s.kt)("p",null,"Example 1 journey vs illustrative tests - ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/blob/main/depinject/features/bindings.feature"},"depinject's BDD style tests"),", show how we can\nrapidly build up many illustrative cases demonstrating behavioral rules without ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/blob/main/depinject/binding_test.go"},"very much code")," while maintaining high level readability."),(0,s.kt)("p",null,"Example 2 ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/blob/main/depinject/provider_desc_test.go"},"depinject table driven tests")),(0,s.kt)("p",null,"Example 3 ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/blob/2bec9d2021918650d3938c3ab242f84289daef80/x/bank/keeper/keeper_test.go#L94-L105"},"Bank keeper tests")," - A mock implementation of ",(0,s.kt)("inlineCode",{parentName:"p"},"AccountKeeper")," is supplied to the keeper constructor."),(0,s.kt)("h4",{id:"limitations"},"Limitations"),(0,s.kt)("p",null,"Certain modules are tightly coupled beyond the test phase. A recent dependency report for\n",(0,s.kt)("inlineCode",{parentName:"p"},"bank -> auth")," found 274 total usages of ",(0,s.kt)("inlineCode",{parentName:"p"},"auth")," in ",(0,s.kt)("inlineCode",{parentName:"p"},"bank"),", 50 of which are in\nproduction code and 224 in test. This tight coupling may suggest that either the modules\nshould be merged, or refactoring is required to abstract references to the core types tying\nthe modules together. It could also indicate that these modules should be tested together\nin integration tests beyond mocked unit tests."),(0,s.kt)("p",null,"In some cases setting up a test case for a module with many mocked dependencies can be quite\ncumbersome and the resulting test may only show that the mocking framework works as expected\nrather than working as a functional test of interdependent module behavior."),(0,s.kt)("h3",{id:"integration-tests"},"Integration tests"),(0,s.kt)("p",null,"Integration tests define and exercise relationships between an arbitrary number of modules\nand/or application subsystems."),(0,s.kt)("p",null,"Wiring for integration tests is provided by ",(0,s.kt)("inlineCode",{parentName:"p"},"depinject")," and some ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/blob/2bec9d2021918650d3938c3ab242f84289daef80/testutil/sims/app_helpers.go#L95"},"helper code")," starts up\na running application. A section of the running application may then be tested. Certain\ninputs during different phases of the application life cycle are expected to produce\ninvariant outputs without too much concern for component internals. This type of black box\ntesting has a larger scope than unit testing."),(0,s.kt)("p",null,"Example 1 ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/blob/2bec9d2021918650d3938c3ab242f84289daef80/client/grpc_query_test.go#L111-L129"},"client/grpc_query_test/TestGRPCQuery")," - This test is misplaced in ",(0,s.kt)("inlineCode",{parentName:"p"},"/client"),",\nbut tests the life cycle of (at least) ",(0,s.kt)("inlineCode",{parentName:"p"},"runtime")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"bank")," as they progress through\nstartup, genesis and query time. It also exercises the fitness of the client and query\nserver without putting bytes on the wire through the use of ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/blob/2bec9d2021918650d3938c3ab242f84289daef80/baseapp/grpcrouter_helpers.go#L31"},"QueryServiceTestHelper"),"."),(0,s.kt)("p",null,"Example 2 ",(0,s.kt)("inlineCode",{parentName:"p"},"x/evidence")," Keeper integration tests - Starts up an application composed of ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/blob/2bec9d2021918650d3938c3ab242f84289daef80/x/evidence/testutil/app.yaml#L1"},"8\nmodules")," with ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/blob/2bec9d2021918650d3938c3ab242f84289daef80/x/evidence/keeper/keeper_test.go#L101-L106"},"5 keepers")," used in the integration test suite. One test in the suite\nexercises ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/blob/2bec9d2021918650d3938c3ab242f84289daef80/x/evidence/keeper/infraction_test.go#L42"},"HandleEquivocationEvidence")," which contains many interactions with the staking\nkeeper."),(0,s.kt)("p",null,"Example 3 - Integration suite app configurations may also be specified via golang (not\nYAML as above) ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/blob/main/x/nft/testutil/app_config.go"},"statically")," or ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/blob/8c23f6f957d1c0bedd314806d1ac65bea59b084c/tests/integration/bank/keeper/keeper_test.go#L129-L134"},"dynamically"),"."),(0,s.kt)("h4",{id:"limitations-1"},"Limitations"),(0,s.kt)("p",null,"Setting up a particular input state may be more challenging since the application is\nstarting from a zero state. Some of this may be addressed by good test fixture\nabstractions with testing of their own. Tests may also be more brittle, and larger\nrefactors could impact application initialization in unexpected ways with harder to\nunderstand errors. This could also be seen as a benefit, and indeed the SDK's current\nintegration tests were helpful in tracking down logic errors during earlier stages\nof app-wiring refactors."),(0,s.kt)("h3",{id:"simulations"},"Simulations"),(0,s.kt)("p",null,"Simulations (also called generative testing) are a special case of integration tests where\ndeterministically random module operations are executed against a running simapp, building\nblocks on the chain until a specified height is reached. No ",(0,s.kt)("em",{parentName:"p"},"specific")," assertions are\nmade for the state transitions resulting from module operations but any error will halt and\nfail the simulation. Since ",(0,s.kt)("inlineCode",{parentName:"p"},"crisis")," is included in simapp and the simulation runs\nEndBlockers at the end of each block any module invariant violations will also fail\nthe simulation."),(0,s.kt)("p",null,"Modules must implement ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/blob/2bec9d2021918650d3938c3ab242f84289daef80/types/module/simulation.go#L31"},"AppModuleSimulation.WeightedOperations")," to define their\nsimulation operations. Note that not all modules implement this which may indicate a\ngap in current simulation test coverage."),(0,s.kt)("p",null,"Modules not returning simulation operations:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"auth")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"evidence")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"mint")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"params"))),(0,s.kt)("p",null,"A separate binary, ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/tools/tree/master/cmd/runsim"},"runsim"),", is responsible for kicking off some of these tests and\nmanaging their life cycle."),(0,s.kt)("h4",{id:"limitations-2"},"Limitations"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"https://github.com/cosmos/cosmos-sdk/runs/7606931983?check_suite_focus=true"},"A success")," may take a long time to run, 7-10 minutes per simulation in CI."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"https://github.com/cosmos/cosmos-sdk/runs/7606932295?check_suite_focus=true"},"Timeouts")," sometimes occur on apparent successes without any indication why."),(0,s.kt)("li",{parentName:"ul"},"Useful error messages not provided on ",(0,s.kt)("a",{parentName:"li",href:"https://github.com/cosmos/cosmos-sdk/runs/7606932548?check_suite_focus=true"},"failure")," from CI, requiring a developer to run\nthe simulation locally to reproduce.")),(0,s.kt)("h3",{id:"e2e-tests"},"E2E tests"),(0,s.kt)("p",null,"End to end tests exercise the entire system as we understand it in as close an approximation\nto a production environment as is practical. Presently these tests are located at\n",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/tree/main/tests/e2e"},"tests/e2e")," and rely on ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/tree/main/testutil/network"},"testutil/network")," to start up an in-process Tendermint node."),(0,s.kt)("p",null,"An application should be built as minimally as possible to exercise the desired functionality.\nThe SDK uses an application will only the required modules for the tests. The application developer is adviced to use its own application for e2e tests."),(0,s.kt)("h4",{id:"limitations-3"},"Limitations"),(0,s.kt)("p",null,"In general the limitations of end to end tests are orchestration and compute cost.\nScaffolding is required to start up and run a prod-like environment and the this\nprocess takes much longer to start and run than unit or integration tests."),(0,s.kt)("p",null,"Global locks present in Tendermint code cause stateful starting/stopping to sometimes hang\nor fail intermittently when run in a CI environment."),(0,s.kt)("p",null,"The scope of e2e tests has been complected with command line interface testing."),(0,s.kt)("h2",{id:"decision"},"Decision"),(0,s.kt)("p",null,"We accept these test scopes and identify the following decisions points for each."),(0,s.kt)("table",null,(0,s.kt)("thead",{parentName:"table"},(0,s.kt)("tr",{parentName:"thead"},(0,s.kt)("th",{parentName:"tr",align:null},"Scope"),(0,s.kt)("th",{parentName:"tr",align:null},"App Type"),(0,s.kt)("th",{parentName:"tr",align:null},"Mocks?"))),(0,s.kt)("tbody",{parentName:"table"},(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"Unit"),(0,s.kt)("td",{parentName:"tr",align:null},"None"),(0,s.kt)("td",{parentName:"tr",align:null},"Yes")),(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"Integration"),(0,s.kt)("td",{parentName:"tr",align:null},"integration helpers"),(0,s.kt)("td",{parentName:"tr",align:null},"Some")),(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"Simulation"),(0,s.kt)("td",{parentName:"tr",align:null},"minimal app"),(0,s.kt)("td",{parentName:"tr",align:null},"No")),(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"E2E"),(0,s.kt)("td",{parentName:"tr",align:null},"minimal app"),(0,s.kt)("td",{parentName:"tr",align:null},"No")))),(0,s.kt)("p",null,"The decision above is valid for the SDK. An application developer should test their application with their full application instead of the minimal app."),(0,s.kt)("h3",{id:"unit-tests-1"},"Unit Tests"),(0,s.kt)("p",null,"All modules must have mocked unit test coverage."),(0,s.kt)("p",null,"Illustrative tests should outnumber journeys in unit tests."),(0,s.kt)("p",null,"Unit tests should outnumber integration tests."),(0,s.kt)("p",null,"Unit tests must not introduce additional dependencies beyond those already present in\nproduction code."),(0,s.kt)("p",null,"When module unit test introduction as per ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/issues/12398"},"EPIC: Unit testing of modules via mocks"),"\nresults in a near complete rewrite of an integration test suite the test suite should be\nretained and moved to ",(0,s.kt)("inlineCode",{parentName:"p"},"/tests/integration"),". We accept the resulting test logic\nduplication but recommend improving the unit test suite through the addition of\nillustrative tests."),(0,s.kt)("h3",{id:"integration-tests-1"},"Integration Tests"),(0,s.kt)("p",null,"All integration tests shall be located in ",(0,s.kt)("inlineCode",{parentName:"p"},"/tests/integration"),", even those which do not\nintroduce extra module dependencies."),(0,s.kt)("p",null,"To help limit scope and complexity, it is recommended to use the smallest possible number of\nmodules in application startup, i.e. don't depend on simapp."),(0,s.kt)("p",null,"Integration tests should outnumber e2e tests."),(0,s.kt)("h3",{id:"simulations-1"},"Simulations"),(0,s.kt)("p",null,"Simulations shall use a minimal application (usually via app wiring). They are located under ",(0,s.kt)("inlineCode",{parentName:"p"},"/x/{moduleName}/simulation"),"."),(0,s.kt)("h3",{id:"e2e-tests-1"},"E2E Tests"),(0,s.kt)("p",null,"Existing e2e tests shall be migrated to integration tests by removing the dependency on the\ntest network and in-process Tendermint node to ensure we do not lose test coverage."),(0,s.kt)("p",null,"The e2e rest runner shall transition from in process Tendermint to a runner powered by\nDocker via ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/ory/dockertest"},"dockertest"),"."),(0,s.kt)("p",null,"E2E tests exercising a full network upgrade shall be written."),(0,s.kt)("p",null,"The CLI testing aspect of existing e2e tests shall be rewritten using the network mocking\ndemonstrated in ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/pull/12706"},"PR#12706"),"."),(0,s.kt)("h2",{id:"consequences"},"Consequences"),(0,s.kt)("h3",{id:"positive"},"Positive"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"test coverage is increased"),(0,s.kt)("li",{parentName:"ul"},"test organization is improved"),(0,s.kt)("li",{parentName:"ul"},"reduced dependency graph size in modules"),(0,s.kt)("li",{parentName:"ul"},"simapp removed as a dependency from modules"),(0,s.kt)("li",{parentName:"ul"},"inter-module dependencies introduced in test code are removed"),(0,s.kt)("li",{parentName:"ul"},"reduced CI run time after transitioning away from in process Tendermint")),(0,s.kt)("h3",{id:"negative"},"Negative"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"some test logic duplication between unit and integration tests during transition"),(0,s.kt)("li",{parentName:"ul"},"test written using dockertest DX may be a bit worse")),(0,s.kt)("h3",{id:"neutral"},"Neutral"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"some discovery required for e2e transition to dockertest")),(0,s.kt)("h2",{id:"further-discussions"},"Further Discussions"),(0,s.kt)("p",null,"It may be useful if test suites could be run in integration mode (with mocked tendermint) or\nwith e2e fixtures (with real tendermint and many nodes). Integration fixtures could be used\nfor quicker runs, e2e fixures could be used for more battle hardening."),(0,s.kt)("p",null,"A PoC ",(0,s.kt)("inlineCode",{parentName:"p"},"x/gov")," was completed in PR ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cosmos/cosmos-sdk/pull/12847"},"#12847"),"\nis in progress for unit tests demonstrating BDD ","[Rejected]",".\nObserving that a strength of BDD specifications is their readability, and a con is the\ncognitive load while writing and maintaining, current consensus is to reserve BDD use\nfor places in the SDK where complex rules and module interactions are demonstrated.\nMore straightforward or low level test cases will continue to rely on go table tests."),(0,s.kt)("p",null,"Levels are network mocking in integration and e2e tests are still being worked on and formalized."))}d.isMDXComponent=!0}}]);