(window.webpackJsonp=window.webpackJsonp||[]).push([[292],{824:function(t,e,a){"use strict";a.r(e);var n=a(1),s=Object(n.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"generating-signing-and-broadcasting-transactions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#generating-signing-and-broadcasting-transactions"}},[t._v("#")]),t._v(" Generating, Signing and Broadcasting Transactions")]),t._v(" "),a("p",{attrs:{synopsis:""}},[t._v("This document describes how to generate an (unsigned) transaction, signing it (with one or multiple keys), and broadcasting it to the network.")]),t._v(" "),a("h2",{attrs:{id:"using-the-cli"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#using-the-cli"}},[t._v("#")]),t._v(" Using the CLI")]),t._v(" "),a("p",[t._v("The easiest way to send transactions is using the CLI, as we have seen in the previous page when "),a("RouterLink",{attrs:{to:"/run-node/interact-node.html#using-the-cli"}},[t._v("interacting with a node")]),t._v(". For example, running the following command")],1),t._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"c2ltZCB0eCBiYW5rIHNlbmQgJE1ZX1ZBTElEQVRPUl9BRERSRVNTICRSRUNJUElFTlQgMTAwMHN0YWtlIC0tY2hhaW4taWQgbXktdGVzdC1jaGFpbiAtLWtleXJpbmctYmFja2VuZCB0ZXN0Cg=="}}),t._v(" "),a("p",[t._v("will run the following steps:")]),t._v(" "),a("ul",[a("li",[t._v("generate a transaction with one "),a("code",[t._v("Msg")]),t._v(" ("),a("code",[t._v("x/bank")]),t._v("'s "),a("code",[t._v("MsgSend")]),t._v("), and print the generated transaction to the console.")]),t._v(" "),a("li",[t._v("ask the user for confirmation to send the transaction from the "),a("code",[t._v("$MY_VALIDATOR_ADDRESS")]),t._v(" account.")]),t._v(" "),a("li",[t._v("fetch "),a("code",[t._v("$MY_VALIDATOR_ADDRESS")]),t._v(" from the keyring. This is possible because we have "),a("RouterLink",{attrs:{to:"/run-node/keyring.html"}},[t._v("set up the CLI's keyring")]),t._v(" in a previous step.")],1),t._v(" "),a("li",[t._v("sign the generated transaction with the keyring's account.")]),t._v(" "),a("li",[t._v("broadcast the signed transaction to the network. This is possible because the CLI connects to the node's Tendermint RPC endpoint.")])]),t._v(" "),a("p",[t._v("The CLI bundles all the necessary steps into a simple-to-use user experience. However, it's possible to run all the steps individually too.")]),t._v(" "),a("h3",{attrs:{id:"generating-a-transaction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#generating-a-transaction"}},[t._v("#")]),t._v(" Generating a Transaction")]),t._v(" "),a("p",[t._v("Generating a transaction can simply be done by appending the "),a("code",[t._v("--generate-only")]),t._v(" flag on any "),a("code",[t._v("tx")]),t._v(" command, e.g.:")]),t._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"c2ltZCB0eCBiYW5rIHNlbmQgJE1ZX1ZBTElEQVRPUl9BRERSRVNTICRSRUNJUElFTlQgMTAwMHN0YWtlIC0tY2hhaW4taWQgbXktdGVzdC1jaGFpbiAtLWdlbmVyYXRlLW9ubHkK"}}),t._v(" "),a("p",[t._v("This will output the unsigned transaction as JSON in the console. We can also save the unsigned transaction to a file (to be passed around between signers more easily) by appending "),a("code",[t._v("> unsigned_tx.json")]),t._v(" to the above command.")]),t._v(" "),a("h3",{attrs:{id:"signing-a-transaction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#signing-a-transaction"}},[t._v("#")]),t._v(" Signing a Transaction")]),t._v(" "),a("p",[t._v("Signing a transaction using the CLI requires the unsigned transaction to be saved in a file. Let's assume the unsigned transaction is in a file called "),a("code",[t._v("unsigned_tx.json")]),t._v(" in the current directory (see previous paragraph on how to do that). Then, simply run the following command:")]),t._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"c2ltZCB0eCBzaWduIHVuc2lnbmVkX3R4Lmpzb24gLS1jaGFpbi1pZCBteS10ZXN0LWNoYWluIC0ta2V5cmluZy1iYWNrZW5kIHRlc3QgLS1mcm9tICRNWV9WQUxJREFUT1JfQUREUkVTUwo="}}),t._v(" "),a("p",[t._v("This command will decode the unsigned transaction and sign it with "),a("code",[t._v("SIGN_MODE_DIRECT")]),t._v(" with "),a("code",[t._v("$MY_VALIDATOR_ADDRESS")]),t._v("'s key, which we already set up in the keyring. The signed transaction will be output as JSON to the console, and, as above, we can save it to a file by appending "),a("code",[t._v("> signed_tx.json")]),t._v(".")]),t._v(" "),a("p",[t._v("Some useful flags to consider in the "),a("code",[t._v("tx sign")]),t._v(" command:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("--sign-mode")]),t._v(": you may use "),a("code",[t._v("amino-json")]),t._v(" to sign the transaction using "),a("code",[t._v("SIGN_MODE_LEGACY_AMINO_JSON")]),t._v(",")]),t._v(" "),a("li",[a("code",[t._v("--offline")]),t._v(": sign in offline mode. This means that the "),a("code",[t._v("tx sign")]),t._v(" command doesn't connect to the node to retrieve the signer's account number and sequence, both needed for signing. In this case, you must manually supply the "),a("code",[t._v("--account-number")]),t._v(" and "),a("code",[t._v("--sequence")]),t._v(" flags. This is useful for offline signing, i.e. signing in a secure environment which doesn't have access to the internet.")])]),t._v(" "),a("h4",{attrs:{id:"signing-with-multiple-signers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#signing-with-multiple-signers"}},[t._v("#")]),t._v(" Signing with Multiple Signers")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",[t._v("Please note that signing a transaction with multiple signers or with a multisig account, where at least one signer uses "),a("code",[t._v("SIGN_MODE_DIRECT")]),t._v(", is not yet possible. You may follow "),a("a",{attrs:{href:"https://github.com/cosmos/cosmos-sdk/issues/8141",target:"_blank",rel:"noopener noreferrer"}},[t._v("this Github issue"),a("OutboundLink")],1),t._v(" for more info.")])]),t._v(" "),a("p",[t._v("Signing with multiple signers is done with the "),a("code",[t._v("tx multisign")]),t._v(" command. This command assumes that all signers use "),a("code",[t._v("SIGN_MODE_LEGACY_AMINO_JSON")]),t._v(". The flow is similar to the "),a("code",[t._v("tx sign")]),t._v(" command flow, but instead of signing an unsigned transaction file, each signer signs the file signed by previous signer(s). The "),a("code",[t._v("tx multisign")]),t._v(" command will append signatures to the existing transactions. It is important that signers sign the transaction "),a("strong",[t._v("in the same order")]),t._v(" as given by the transaction, which is retrievable using the "),a("code",[t._v("GetSigners()")]),t._v(" method.")]),t._v(" "),a("p",[t._v("For example, starting with the "),a("code",[t._v("unsigned_tx.json")]),t._v(", and assuming the transaction has 4 signers, we would run:")]),t._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"IyBMZXQgc2lnbmVyMSBzaWduIHRoZSB1bnNpZ25lZCB0eC4Kc2ltZCB0eCBtdWx0aXNpZ25zaWduIHVuc2lnbmVkX3R4Lmpzb24gc2lnbmVyX2tleV8xIC0tY2hhaW4taWQgbXktdGVzdC1jaGFpbiAtLWtleXJpbmctYmFja2VuZCB0ZXN0ICZndDsgcGFydGlhbF90eF8xLmpzb24KIyBOb3cgc2lnbmVyMSB3aWxsIHNlbmQgdGhlIHBhcnRpYWxfdHhfMS5qc29uIHRvIHRoZSBzaWduZXIyLgojIFNpZ25lcjIgYXBwZW5kcyB0aGVpciBzaWduYXR1cmU6CnNpbWQgdHggbXVsdGlzaWduc2lnbiBwYXJ0aWFsX3R4XzEuanNvbiBzaWduZXJfa2V5XzIgLS1jaGFpbi1pZCBteS10ZXN0LWNoYWluIC0ta2V5cmluZy1iYWNrZW5kIHRlc3QgJmd0OyBwYXJ0aWFsX3R4XzIuanNvbgojIFNpZ25lcjIgc2VuZHMgdGhlIHBhcnRpYWxfdHhfMi5qc29uIGZpbGUgdG8gc2lnbmVyMywgYW5kIHNpZ25lcjMgY2FuIGFwcGVuZCBoaXMgc2lnbmF0dXJlOgpzaW1kIHR4IG11bHRpc2lnbnNpZ24gcGFydGlhbF90eF8yLmpzb24gc2lnbmVyX2tleV8zIC0tY2hhaW4taWQgbXktdGVzdC1jaGFpbiAtLWtleXJpbmctYmFja2VuZCB0ZXN0ICZndDsgcGFydGlhbF90eF8zLmpzb24K"}}),t._v(" "),a("h3",{attrs:{id:"broadcasting-a-transaction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#broadcasting-a-transaction"}},[t._v("#")]),t._v(" Broadcasting a Transaction")]),t._v(" "),a("p",[t._v("Broadcasting a transaction is done using the following command:")]),t._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"c2ltZCB0eCBicm9hZGNhc3QgdHhfc2lnbmVkLmpzb24K"}}),t._v(" "),a("p",[t._v("You may optionally pass the "),a("code",[t._v("--broadcast-mode")]),t._v(" flag to specify which response to receive from the node:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("block")]),t._v(": the CLI waits for the tx to be committed in a block.")]),t._v(" "),a("li",[a("code",[t._v("sync")]),t._v(": the CLI waits for a CheckTx execution response only.")]),t._v(" "),a("li",[a("code",[t._v("async")]),t._v(": the CLI returns immediately (transaction might fail).")])]),t._v(" "),a("h2",{attrs:{id:"programmatically-with-go"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#programmatically-with-go"}},[t._v("#")]),t._v(" Programmatically with Go")]),t._v(" "),a("p",[t._v("It is possible to manipulate transactions programmatically via Go using the Cosmos SDK's "),a("code",[t._v("TxBuilder")]),t._v(" interface.")]),t._v(" "),a("h3",{attrs:{id:"generating-a-transaction-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#generating-a-transaction-2"}},[t._v("#")]),t._v(" Generating a Transaction")]),t._v(" "),a("p",[t._v("Before generating a transaction, a new instance of a "),a("code",[t._v("TxBuilder")]),t._v(" needs to be created. Since the SDK supports both Amino and Protobuf transactions, the first step would be to decide which encoding scheme to use. All the subsequent steps remain unchanged, whether you're using Amino or Protobuf, as "),a("code",[t._v("TxBuilder")]),t._v(" abstracts the encoding mechanisms. In the following snippet, we will use Protobuf.")]),t._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"aW1wb3J0ICgKCSZxdW90O2dpdGh1Yi5jb20vY29zbW9zL2Nvc21vcy1zZGsvc2ltYXBwJnF1b3Q7CikKCmZ1bmMgc2VuZFR4KCkgZXJyb3IgewogICAgLy8gQ2hvb3NlIHlvdXIgY29kZWM6IEFtaW5vIG9yIFByb3RvYnVmLiBIZXJlLCB3ZSB1c2UgUHJvdG9idWYsIGdpdmVuIGJ5IHRoZQogICAgLy8gZm9sbG93aW5nIGZ1bmN0aW9uLgogICAgZW5jQ2ZnIDo9IHNpbWFwcC5NYWtlVGVzdEVuY29kaW5nQ29uZmlnKCkKCiAgICAvLyBDcmVhdGUgYSBuZXcgVHhCdWlsZGVyLgogICAgdHhCdWlsZGVyIDo9IGVuY0NmZy5UeENvbmZpZy5OZXdUeEJ1aWxkZXIoKQoKICAgIC8vIC0tc25pcC0tCn0K"}}),t._v(" "),a("p",[t._v("We can also set up some keys and addresses that will send and receive the transactions. Here, for the purpose of the tutorial, we will be using some dummy data to create keys.")]),t._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"aW1wb3J0ICgKCSZxdW90O2dpdGh1Yi5jb20vY29zbW9zL2Nvc21vcy1zZGsvdGVzdHV0aWwvdGVzdGRhdGEmcXVvdDsKKQoKcHJpdjEsIF8sIGFkZHIxIDo9IHRlc3RkYXRhLktleVRlc3RQdWJBZGRyKCkKcHJpdjIsIF8sIGFkZHIyIDo9IHRlc3RkYXRhLktleVRlc3RQdWJBZGRyKCkKcHJpdjMsIF8sIGFkZHIzIDo9IHRlc3RkYXRhLktleVRlc3RQdWJBZGRyKCkK"}}),t._v(" "),a("p",[t._v("Populating the "),a("code",[t._v("TxBuilder")]),t._v(" can be done via its "),a("a",{attrs:{href:"https://github.com/cosmos/cosmos-sdk/blob/v0.40.0-rc6/client/tx_config.go#L32-L45",target:"_blank",rel:"noopener noreferrer"}},[t._v("methods"),a("OutboundLink")],1),t._v(":")]),t._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"aW1wb3J0ICgKCWJhbmt0eXBlcyAmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3gvYmFuay90eXBlcyZxdW90OwopCgpmdW5jIHNlbmRUeCgpIGVycm9yIHsKICAgIC8vIC0tc25pcC0tCgogICAgLy8gRGVmaW5lIHR3byB4L2JhbmsgTXNnU2VuZCBtZXNzYWdlczoKICAgIC8vIC0gZnJvbSBhZGRyMSB0byBhZGRyMywKICAgIC8vIC0gZnJvbSBhZGRyMiB0byBhZGRyMy4KICAgIC8vIFRoaXMgbWVhbnMgdGhhdCB0aGUgdHJhbnNhY3Rpb25zIG5lZWRzIHR3byBzaWduZXJzOiBhZGRyMSBhbmQgYWRkcjIuCiAgICBtc2cxIDo9IGJhbmt0eXBlcy5OZXdNc2dTZW5kKGFkZHIxLCBhZGRyMywgdHlwZXMuTmV3Q29pbnModHlwZXMuTmV3SW50NjRDb2luKCZxdW90O2F0b20mcXVvdDssIDEyKSkpCiAgICBtc2cyIDo9IGJhbmt0eXBlcy5OZXdNc2dTZW5kKGFkZHIyLCBhZGRyMywgdHlwZXMuTmV3Q29pbnModHlwZXMuTmV3SW50NjRDb2luKCZxdW90O2F0b20mcXVvdDssIDM0KSkpCgogICAgZXJyIDo9IHR4QnVpbGRlci5TZXRNc2dzKG1zZzEsIG1zZzIpCiAgICBpZiBlcnIgIT0gbmlsIHsKICAgICAgICByZXR1cm4gZXJyCiAgICB9CgogICAgdHhCdWlsZGVyLlNldEdhc0xpbWl0KC4uLikKICAgIHR4QnVpbGRlci5TZXRGZWVBbW91bnQoLi4uKQogICAgdHhCdWlsZGVyLlNldE1lbW8oLi4uKQogICAgdHhCdWlsZGVyLlNldFRpbWVvdXRIZWlnaHQoLi4uKQp9Cg=="}}),t._v(" "),a("p",[t._v("At this point, "),a("code",[t._v("TxBuilder")]),t._v("'s underlying transaction is ready to be signed.")]),t._v(" "),a("h3",{attrs:{id:"signing-a-transaction-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#signing-a-transaction-2"}},[t._v("#")]),t._v(" Signing a Transaction")]),t._v(" "),a("p",[t._v("We set encoding config to use Protobuf, which will use "),a("code",[t._v("SIGN_MODE_DIRECT")]),t._v(" by default. As per "),a("a",{attrs:{href:"https://github.com/cosmos/cosmos-sdk/blob/v0.40.0-rc6/docs/architecture/adr-020-protobuf-transaction-encoding.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("ADR-020"),a("OutboundLink")],1),t._v(", each signer needs to sign the "),a("code",[t._v("SignerInfo")]),t._v("s of all other signers. This means that we need to perform two steps sequentially:")]),t._v(" "),a("ul",[a("li",[t._v("for each signer, populate the signer's "),a("code",[t._v("SignerInfo")]),t._v(" inside "),a("code",[t._v("TxBuilder")]),t._v(",")]),t._v(" "),a("li",[t._v("once all "),a("code",[t._v("SignerInfo")]),t._v("s are populated, for each signer, sign the "),a("code",[t._v("SignDoc")]),t._v(" (the payload to be signed).")])]),t._v(" "),a("p",[t._v("In the current "),a("code",[t._v("TxBuilder")]),t._v("'s API, both steps are done using the same method: "),a("code",[t._v("SetSignatures()")]),t._v(". The current API requires us to first perform a round of "),a("code",[t._v("SetSignatures()")]),t._v(" "),a("em",[t._v("with empty signatures")]),t._v(", only to populate "),a("code",[t._v("SignerInfo")]),t._v("s, and a second round of "),a("code",[t._v("SetSignatures()")]),t._v(" to actually sign the correct payload.")]),t._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"aW1wb3J0ICgKICAgIGNyeXB0b3R5cGVzICZxdW90O2dpdGh1Yi5jb20vY29zbW9zL2Nvc21vcy1zZGsvY3J5cHRvL3R5cGVzJnF1b3Q7CgkmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3R5cGVzL3R4L3NpZ25pbmcmcXVvdDsKCXhhdXRoc2lnbmluZyAmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3gvYXV0aC9zaWduaW5nJnF1b3Q7CikKCmZ1bmMgc2VuZFR4KCkgZXJyb3IgewogICAgLy8gLS1zbmlwLS0KCiAgICBwcml2cyA6PSBbXWNyeXB0b3R5cGVzLlByaXZLZXl7cHJpdjEsIHByaXYyfQogICAgYWNjTnVtczo9IFtddWludDY0ey4uLiwgLi4ufSAvLyBUaGUgYWNjb3VudHMnIGFjY291bnQgbnVtYmVycwogICAgYWNjU2Vxczo9IFtddWludDY0ey4uLiwgLi4ufSAvLyBUaGUgYWNjb3VudHMnIHNlcXVlbmNlIG51bWJlcnMKCiAgICAvLyBGaXJzdCByb3VuZDogd2UgZ2F0aGVyIGFsbCB0aGUgc2lnbmVyIGluZm9zLiBXZSB1c2UgdGhlICZxdW90O3NldCBlbXB0eQogICAgLy8gc2lnbmF0dXJlJnF1b3Q7IGhhY2sgdG8gZG8gdGhhdC4KICAgIHZhciBzaWdzVjIgW11zaWduaW5nLlNpZ25hdHVyZVYyCiAgICBmb3IgaSwgcHJpdiA6PSByYW5nZSBwcml2cyB7CiAgICAgICAgc2lnVjIgOj0gc2lnbmluZy5TaWduYXR1cmVWMnsKICAgICAgICAgICAgUHViS2V5OiBwcml2LlB1YktleSgpLAogICAgICAgICAgICBEYXRhOiAmYW1wO3NpZ25pbmcuU2luZ2xlU2lnbmF0dXJlRGF0YXsKICAgICAgICAgICAgICAgIFNpZ25Nb2RlOiAgZW5jQ2ZnLlR4Q29uZmlnLlNpZ25Nb2RlSGFuZGxlcigpLkRlZmF1bHRNb2RlKCksCiAgICAgICAgICAgICAgICBTaWduYXR1cmU6IG5pbCwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgU2VxdWVuY2U6IGFjY1NlcXNbaV0sCiAgICAgICAgfQoKICAgICAgICBzaWdzVjIgPSBhcHBlbmQoc2lnc1YyLCBzaWdWMikKICAgIH0KICAgIGVyciA6PSB0eEJ1aWxkZXIuU2V0U2lnbmF0dXJlcyhzaWdzVjIuLi4pCiAgICBpZiBlcnIgIT0gbmlsIHsKICAgICAgICByZXR1cm4gZXJyCiAgICB9CgogICAgLy8gU2Vjb25kIHJvdW5kOiBhbGwgc2lnbmVyIGluZm9zIGFyZSBzZXQsIHNvIGVhY2ggc2lnbmVyIGNhbiBzaWduLgogICAgc2lnc1YyID0gW11zaWduaW5nLlNpZ25hdHVyZVYye30KICAgIGZvciBpLCBwcml2IDo9IHJhbmdlIHByaXZzIHsKICAgICAgICBzaWduZXJEYXRhIDo9IHhhdXRoc2lnbmluZy5TaWduZXJEYXRhewogICAgICAgICAgICBDaGFpbklEOiAgICAgICBjaGFpbklELAogICAgICAgICAgICBBY2NvdW50TnVtYmVyOiBhY2NOdW1zW2ldLAogICAgICAgICAgICBTZXF1ZW5jZTogICAgICBhY2NTZXFzW2ldLAogICAgICAgIH0KICAgICAgICBzaWdWMiwgZXJyIDo9IHR4LlNpZ25XaXRoUHJpdktleSgKICAgICAgICAgICAgZW5jQ2ZnLlR4Q29uZmlnLlNpZ25Nb2RlSGFuZGxlcigpLkRlZmF1bHRNb2RlKCksIHNpZ25lckRhdGEsCiAgICAgICAgICAgIHR4QnVpbGRlciwgcHJpdiwgZW5jQ2ZnLlR4Q29uZmlnLCBhY2NTZXFzW2ldKQogICAgICAgIGlmIGVyciAhPSBuaWwgewogICAgICAgICAgICByZXR1cm4gbmlsLCBlcnIKICAgICAgICB9CgogICAgICAgIHNpZ3NWMiA9IGFwcGVuZChzaWdzVjIsIHNpZ1YyKQogICAgfQogICAgZXJyID0gdHhCdWlsZGVyLlNldFNpZ25hdHVyZXMoc2lnc1YyLi4uKQogICAgaWYgZXJyICE9IG5pbCB7CiAgICAgICAgcmV0dXJuIGVycgogICAgfQp9Cg=="}}),t._v(" "),a("p",[t._v("The "),a("code",[t._v("TxBuilder")]),t._v(" is now correctly populated. To print it, you can use the "),a("code",[t._v("TxConfig")]),t._v(" interface from the initial encoding config "),a("code",[t._v("encCfg")]),t._v(":")]),t._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ZnVuYyBzZW5kVHgoKSBlcnJvciB7CiAgICAvLyAtLXNuaXAtLQoKICAgIC8vIEdlbmVyYXRlZCBQcm90b2J1Zi1lbmNvZGVkIGJ5dGVzLgogICAgdHhCeXRlcywgZXJyIDo9IGVuY0NmZy5UeENvbmZpZy5UeEVuY29kZXIoKSh0eEJ1aWxkZXIuR2V0VHgoKSkKICAgIGlmIGVyciAhPSBuaWwgewogICAgICAgIHJldHVybiBlcnIKICAgIH0KCiAgICAvLyBHZW5lcmF0ZSBhIEpTT04gc3RyaW5nLgogICAgdHhKU09OQnl0ZXMsIGVyciA6PSBlbmNDZmcuVHhDb25maWcuVHhKU09ORW5jb2RlcigpKHR4QnVpbGRlci5HZXRUeCgpKQogICAgaWYgZXJyICE9IG5pbCB7CiAgICAgICAgcmV0dXJuIGVycgogICAgfQogICAgdHhKU09OIDo9IHN0cmluZyh0eEpTT05CeXRlcykKfQo="}}),t._v(" "),a("h3",{attrs:{id:"broadcasting-a-transaction-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#broadcasting-a-transaction-2"}},[t._v("#")]),t._v(" Broadcasting a Transaction")]),t._v(" "),a("p",[t._v("The preferred way to broadcast a transaction is to use gRPC, though using REST (via "),a("code",[t._v("gRPC-gateway")]),t._v(") or the Tendermint RPC is also posible. An overview of the differences between these methods is exposed "),a("RouterLink",{attrs:{to:"/core/grpc_rest.html"}},[t._v("here")]),t._v(". For this tutorial, we will only describe the gRPC method.")],1),t._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"aW1wb3J0ICgKICAgICZxdW90O2NvbnRleHQmcXVvdDsKICAgICZxdW90O2ZtdCZxdW90OwoKCSZxdW90O2dvb2dsZS5nb2xhbmcub3JnL2dycGMmcXVvdDsKCgkmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3R5cGVzL3R4JnF1b3Q7CikKCmZ1bmMgc2VuZFR4KGN0eCBjb250ZXh0LkNvbnRleHQpIGVycm9yIHsKICAgIC8vIC0tc25pcC0tCgogICAgLy8gQ3JlYXRlIGEgY29ubmVjdGlvbiB0byB0aGUgZ1JQQyBzZXJ2ZXIuCiAgICBncnBjQ29ubiA6PSBncnBjLkRpYWwoCiAgICAgICAgJnF1b3Q7MTI3LjAuMC4xOjkwOTAmcXVvdDssIC8vIE9yIHlvdXIgZ1JQQyBzZXJ2ZXIgYWRkcmVzcy4KICAgICAgICBncnBjLldpdGhJbnNlY3VyZSgpLCAvLyBUaGUgU0RLIGRvZXNuJ3Qgc3VwcG9ydCBhbnkgdHJhbnNwb3J0IHNlY3VyaXR5IG1lY2hhbmlzbS4KICAgICkKICAgIGRlZmVyIGdycGNDb25uLkNsb3NlKCkKCiAgICAvLyBCcm9hZGNhc3QgdGhlIHR4IHZpYSBnUlBDLiBXZSBjcmVhdGUgYSBuZXcgY2xpZW50IGZvciB0aGUgUHJvdG9idWYgVHgKICAgIC8vIHNlcnZpY2UuCiAgICB0eENsaWVudCA6PSB0eC5OZXdTZXJ2aWNlQ2xpZW50KGdycGNDb25uKQogICAgLy8gV2UgdGhlbiBjYWxsIHRoZSBCcm9hZGNhc3RUeCBtZXRob2Qgb24gdGhpcyBjbGllbnQuCiAgICBncnBjUmVzLCBlcnIgOj0gdHhDbGllbnQuQnJvYWRjYXN0VHgoCiAgICAgICAgY3R4LAogICAgICAgICZhbXA7dHguQnJvYWRjYXN0VHhSZXF1ZXN0ewogICAgICAgICAgICBNb2RlOiAgICB0eC5Ccm9hZGNhc3RNb2RlX0JST0FEQ0FTVF9NT0RFX1NZTkMsCiAgICAgICAgICAgIFR4Qnl0ZXM6IHR4Qnl0ZXMsIC8vIFByb3RvLWJpbmFyeSBvZiB0aGUgc2lnbmVkIHRyYW5zYWN0aW9uLCBzZWUgcHJldmlvdXMgc3RlcC4KICAgICAgICB9LAogICAgKQogICAgaWYgZXJyICE9IG5pbCB7CiAgICAgICAgcmV0dXJuIGVycgogICAgfQoKICAgIGZtdC5QcmludGxuKGdycGNSZXMuVHhSZXNwb25zZS5Db2RlKSAvLyBTaG91bGQgYmUgYDBgIGlmIHRoZSB0eCBpcyBzdWNjZXNzZnVsCgogICAgcmV0dXJuIG5pbAp9Cg=="}}),t._v(" "),a("h4",{attrs:{id:"simulating-a-transaction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#simulating-a-transaction"}},[t._v("#")]),t._v(" Simulating a Transaction")]),t._v(" "),a("p",[t._v("Before broadcasting a transaction, we sometimes may want to dry-run the transaction, to estimate some information about the transaction without actually committing it. This is called simulating a transaction, and can be done as follows:")]),t._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"aW1wb3J0ICgKCSZxdW90O2NvbnRleHQmcXVvdDsKCSZxdW90O2ZtdCZxdW90OwoJJnF1b3Q7dGVzdGluZyZxdW90OwoKCSZxdW90O2dpdGh1Yi5jb20vY29zbW9zL2Nvc21vcy1zZGsvY2xpZW50JnF1b3Q7CgkmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3R5cGVzL3R4JnF1b3Q7CglhdXRodHggJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay94L2F1dGgvdHgmcXVvdDsKKQoKZnVuYyBzaW11bGF0ZVR4KCkgZXJyb3IgewogICAgLy8gLS1zbmlwLS0KCiAgICAvLyBTaW11bGF0ZSB0aGUgdHggdmlhIGdSUEMuIFdlIGNyZWF0ZSBhIG5ldyBjbGllbnQgZm9yIHRoZSBQcm90b2J1ZiBUeAogICAgLy8gc2VydmljZS4KICAgIHR4Q2xpZW50IDo9IHR4Lk5ld1NlcnZpY2VDbGllbnQoZ3JwY0Nvbm4pCiAgICB0eEJ5dGVzIDo9IC8qIEZpbGwgaW4gd2l0aCB5b3VyIHNpZ25lZCB0cmFuc2FjdGlvbiBieXRlcy4gKi8KCiAgICAvLyBXZSB0aGVuIGNhbGwgdGhlIFNpbXVsYXRlIG1ldGhvZCBvbiB0aGlzIGNsaWVudC4KICAgIGdycGNSZXMsIGVyciA6PSB0eENsaWVudC5TaW11bGF0ZSgKICAgICAgICBjb250ZXh0LkJhY2tncm91bmQoKSwKICAgICAgICAmYW1wO3R4LlNpbXVsYXRlUmVxdWVzdHsKICAgICAgICAgICAgVHhCeXRlczogdHhCeXRlcywKICAgICAgICB9LAogICAgKQogICAgaWYgZXJyICE9IG5pbCB7CiAgICAgICAgcmV0dXJuIGVycgogICAgfQoKICAgIGZtdC5QcmludGxuKGdycGNSZXMuR2FzSW5mbykgLy8gUHJpbnRzIGVzdGltYXRlZCBnYXMgdXNlZC4KCiAgICByZXR1cm4gbmlsCn0K"}}),t._v(" "),a("h2",{attrs:{id:"using-grpc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#using-grpc"}},[t._v("#")]),t._v(" Using gRPC")]),t._v(" "),a("p",[t._v("It is not possible to generate or sign a transaction using gRPC, only to broadcast one.")]),t._v(" "),a("h3",{attrs:{id:"broadcasting-a-transaction-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#broadcasting-a-transaction-3"}},[t._v("#")]),t._v(" Broadcasting a Transaction")]),t._v(" "),a("p",[t._v("Broadcasting a transaction using the gRPC endpoint can be done by sending a "),a("code",[t._v("BroadcastTx")]),t._v(" request as follows, where the "),a("code",[t._v("txBytes")]),t._v(" are the protobuf-encoded bytes of a signed transaction:")]),t._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"Z3JwY3VybCAtcGxhaW50ZXh0IFwKICAgIC1kICd7JnF1b3Q7dHhfYnl0ZXMmcXVvdDs6JnF1b3Q7e3t0eEJ5dGVzfX0mcXVvdDssJnF1b3Q7bW9kZSZxdW90OzomcXVvdDtCUk9BRENBU1RfTU9ERV9TWU5DJnF1b3Q7fScgXAogICAgbG9jYWxob3N0OjkwOTAgXAogICAgY29zbW9zLnR4LnYxYmV0YTEuU2VydmljZS9Ccm9hZGNhc3RUeAo="}}),t._v(" "),a("h2",{attrs:{id:"using-rest"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#using-rest"}},[t._v("#")]),t._v(" Using REST")]),t._v(" "),a("p",[t._v("It is not possible to generate or sign a transaction using REST, only to broadcast one.")]),t._v(" "),a("h3",{attrs:{id:"broadcasting-a-transaction-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#broadcasting-a-transaction-4"}},[t._v("#")]),t._v(" Broadcasting a Transaction")]),t._v(" "),a("p",[t._v("Broadcasting a transaction using the REST endpoint (served by "),a("code",[t._v("gRPC-gateway")]),t._v(") can be done by sending a POST request as follows, where the "),a("code",[t._v("txBytes")]),t._v(" are the protobuf-encoded bytes of a signed transaction:")]),t._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"Y3VybCAtWCBQT1NUIFwKICAgIC1IICZxdW90O0NvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvbiZxdW90OyBcCiAgICAtZCd7JnF1b3Q7dHhfYnl0ZXMmcXVvdDs6JnF1b3Q7e3t0eEJ5dGVzfX0mcXVvdDssJnF1b3Q7bW9kZSZxdW90OzomcXVvdDtCUk9BRENBU1RfTU9ERV9TWU5DJnF1b3Q7fScgXAogICAgbG9jYWxob3N0OjEzMTcvY29zbW9zL3R4L3YxYmV0YTEvdHhzCg=="}}),t._v(" "),a("h2",{attrs:{id:"using-cosmjs-javascript-typescript"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#using-cosmjs-javascript-typescript"}},[t._v("#")]),t._v(" Using CosmJS (JavaScript & TypeScript)")]),t._v(" "),a("p",[t._v("CosmJS aims to build client libraries in JavaScript that can be embedded in web applications. Please see "),a("a",{attrs:{href:"https://cosmos.github.io/cosmjs",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://cosmos.github.io/cosmjs"),a("OutboundLink")],1),t._v(" for more information. As of January 2021, CosmJS documentation is still work in progress.")])],1)}),[],!1,null,null,null);e.default=s.exports}}]);